/*! FirehoseJS - v0.1.0 - 2014-01-06
* https://www.getfirehose.com
* Copyright (c) 2014 Adam Kirk; Licensed  */
(function(){var a,b,c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h=this;for(this.Stripe=function(){function a(){}return a.version=2,a.endpoint="https://api.stripe.com/v1",a.setPublishableKey=function(b){a.key=b},a.complete=function(b){return function(c){var d;return"success"!==c?(d=Math.round((new Date).getTime()/1e3),(new Image).src="http://q.stripe.com?event=stripejs-error&type="+c+"&key="+a.key+"&timestamp="+d,"function"==typeof b?b(500,{error:{code:c,type:c,message:"An unexpected error has occurred submitting your credit\ncard to our secure credit card processor. This may be\ndue to network connectivity issues, so you should try\nagain (you won't be charged twice). If this problem\npersists, please let us know!"}}):void 0):void 0}},a}.call(this),a=this.Stripe,this.Stripe.token=function(){function b(){}return b.validate=function(a,b){if(!a)throw b+" required";if("object"!=typeof a)throw b+" invalid"},b.formatData=function(b,c){return a.utils.isElement(b)&&(b=a.utils.paramsFromForm(b,c)),a.utils.underscoreKeys(b),b},b.create=function(b,c){return b.key||(b.key=a.key||a.publishableKey),a.utils.validateKey(b.key),a.ajaxJSONP({url:""+a.endpoint+"/tokens",data:b,method:"POST",success:function(a,b){return"function"==typeof c?c(b,a):void 0},complete:a.complete(c),timeout:4e4})},b.get=function(b,c){if(!b)throw"token required";return a.utils.validateKey(a.key),a.ajaxJSONP({url:""+a.endpoint+"/tokens/"+b,data:{key:a.key},success:function(a,b){return"function"==typeof c?c(b,a):void 0},complete:a.complete(c),timeout:4e4})},b}.call(this),this.Stripe.card=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return g(c,b),c.tokenName="card",c.whitelistedAttrs=["number","cvc","exp_month","exp_year","name","address_line1","address_line2","address_city","address_state","address_zip","address_country"],c.createToken=function(b,d,e){var f;return null==d&&(d={}),a.token.validate(b,"card"),"function"==typeof d?(e=d,d={}):"object"!=typeof d&&(f=parseInt(d,10),d={},f>0&&(d.amount=f)),d[c.tokenName]=a.token.formatData(b,c.whitelistedAttrs),a.token.create(d,e)},c.getToken=function(b,c){return a.token.get(b,c)},c.validateCardNumber=function(a){return a=(a+"").replace(/\s+|-/g,""),a.length>=10&&a.length<=16&&c.luhnCheck(a)},c.validateCVC=function(b){return b=a.utils.trim(b),/^\d+$/.test(b)&&b.length>=3&&b.length<=4},c.validateExpiry=function(b,c){var d,e;return b=a.utils.trim(b),c=a.utils.trim(c),/^\d+$/.test(b)?/^\d+$/.test(c)?parseInt(b,10)<=12?(e=new Date(c,b),d=new Date,e.setMonth(e.getMonth()-1),e.setMonth(e.getMonth()+1,1),e>d):!1:!1:!1},c.luhnCheck=function(a){var b,c,d,e,f,g;for(d=!0,e=0,c=(a+"").split("").reverse(),f=0,g=c.length;g>f;f++)b=c[f],b=parseInt(b,10),(d=!d)&&(b*=2),b>9&&(b-=9),e+=b;return e%10===0},c.cardType=function(a){return c.cardTypes[a.slice(0,2)]||"Unknown"},c.cardTypes=function(){var a,b,c,d;for(b={},a=c=40;49>=c;a=++c)b[a]="Visa";for(a=d=50;59>=d;a=++d)b[a]="MasterCard";return b[34]=b[37]="American Express",b[60]=b[62]=b[64]=b[65]="Discover",b[35]="JCB",b[30]=b[36]=b[38]=b[39]="Diners Club",b}(),c}.call(this,this.Stripe.token),this.Stripe.bankAccount=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return g(c,b),c.tokenName="bank_account",c.whitelistedAttrs=["country","routing_number","account_number"],c.createToken=function(b,d,e){return null==d&&(d={}),a.token.validate(b,"bank account"),"function"==typeof d&&(e=d,d={}),d[c.tokenName]=a.token.formatData(b,c.whitelistedAttrs),a.token.create(d,e)},c.getToken=function(b,c){return a.token.get(b,c)},c.validateRoutingNumber=function(b,d){switch(b=a.utils.trim(b),d){case"US":return/^\d+$/.test(b)&&9===b.length&&c.routingChecksum(b);case"CA":return/\d{5}\-\d{3}/.test(b)&&9===b.length;default:return!0}},c.validateAccountNumber=function(b,c){switch(b=a.utils.trim(b),c){case"US":return/^\d+$/.test(b)&&b.length>=1&&b.length<=17;default:return!0}},c.routingChecksum=function(a){var b,c,d,e,f,g;for(d=0,b=(a+"").split(""),g=[0,3,6],e=0,f=g.length;f>e;e++)c=g[e],d+=3*parseInt(b[c]),d+=7*parseInt(b[c+1]),d+=parseInt(b[c+2]);return 0!==d&&d%10===0},c}.call(this,this.Stripe.token),b=["createToken","getToken","cardType","validateExpiry","validateCVC","validateCardNumber"],d=0,e=b.length;e>d;d++)c=b[d],this.Stripe[c]=this.Stripe.card[c];"undefined"!=typeof module&&null!==module&&(module.exports=this.Stripe),"function"==typeof define&&define("stripe",[],function(){return h.Stripe})}).call(this),function(){var a,b,c,d=[].slice;a=encodeURIComponent,b=(new Date).getTime(),c=function(b,d,e){var f,g;null==d&&(d=[]);for(f in b)g=b[f],e&&(f=""+e+"["+f+"]"),"object"==typeof g?c(g,d,f):d.push(""+f+"="+a(g));return d.join("&").replace(/%20/g,"+")},this.Stripe.ajaxJSONP=function(a){var e,f,g,h,i,j;return null==a&&(a={}),g="sjsonp"+ ++b,i=document.createElement("script"),f=null,e=function(b){var c;return null==b&&(b="abort"),clearTimeout(f),null!=(c=i.parentNode)&&c.removeChild(i),g in window&&(window[g]=function(){}),"function"==typeof a.complete?a.complete(b,j,a):void 0},j={abort:e},i.onerror=function(){return j.abort(),"function"==typeof a.error?a.error(j,a):void 0},window[g]=function(){var b;b=1<=arguments.length?d.call(arguments,0):[],clearTimeout(f),i.parentNode.removeChild(i);try{delete window[g]}catch(c){window[g]=void 0}return"function"==typeof a.success&&a.success.apply(a,b),"function"==typeof a.complete?a.complete("success",j,a):void 0},a.data||(a.data={}),a.data.callback=g,a.method&&(a.data._method=a.method),i.src=a.url+"?"+c(a.data),h=document.getElementsByTagName("head")[0],h.appendChild(i),a.timeout>0&&(f=setTimeout(function(){return j.abort("timeout")},a.timeout)),j}}.call(this),function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};this.Stripe.utils=function(){function b(){}return b.trim=function(a){return(a+"").replace(/^\s+|\s+$/g,"")},b.underscore=function(a){return(a+"").replace(/([A-Z])/g,function(a){return"_"+a.toLowerCase()}).replace(/-/g,"_")},b.underscoreKeys=function(a){var b,c,d;d=[];for(b in a)c=a[b],delete a[b],d.push(a[this.underscore(b)]=c);return d},b.isElement=function(a){return"object"!=typeof a?!1:"undefined"!=typeof jQuery&&null!==jQuery&&a instanceof jQuery?!0:1===a.nodeType},b.paramsFromForm=function(b,c){var d,e,f,g,h,i,j,k,l,m;for(null==c&&(c=[]),"undefined"!=typeof jQuery&&null!==jQuery&&b instanceof jQuery&&(b=b[0]),f=b.getElementsByTagName("input"),h=b.getElementsByTagName("select"),i={},j=0,l=f.length;l>j;j++)e=f[j],d=this.underscore(e.getAttribute("data-stripe")),a.call(c,d)<0||(i[d]=e.value);for(k=0,m=h.length;m>k;k++)g=h[k],d=this.underscore(g.getAttribute("data-stripe")),a.call(c,d)<0||null!=g.selectedIndex&&(i[d]=g.options[g.selectedIndex].value);return i},b.validateKey=function(a){if(!a||"string"!=typeof a)throw new Error("You did not set a valid publishable key. Call Stripe.setPublishableKey() with your publishable key. For more info, see https://stripe.com/docs/stripe.js");if(/\s/g.test(a))throw new Error("Your key is invalid, as it contains whitespace. For more info, see https://stripe.com/docs/stripe.js");if(/^sk_/.test(a))throw new Error("You are using a secret key with Stripe.js, instead of the publishable one. For more info, see https://stripe.com/docs/stripe.js")},b}()}.call(this),function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};this.Stripe.validator={"boolean":function(a,b){return"true"!==b&&"false"!==b?"Enter a boolean string (true or false)":void 0},integer:function(a,b){return/^\d+$/.test(b)?void 0:"Enter an integer"},positive:function(a,b){return!this.integer(a,b)&&parseInt(b,10)>0?void 0:"Enter a positive value"},range:function(b,c){var d;return d=parseInt(c,10),a.call(b,d)<0?"Needs to be between "+b[0]+" and "+b[b.length-1]:void 0},required:function(a,b){return!a||null!=b&&""!==b?void 0:"Required"},year:function(a,b){return/^\d{4}$/.test(b)?void 0:"Enter a 4-digit year"},birthYear:function(a,b){var c;return c=this.year(a,b),c?c:parseInt(b,10)>2e3?"You must be over 18":parseInt(b,10)<1900?"Enter your birth year":void 0},month:function(a,b){return this.integer(a,b)?"Please enter a month":this.range([1,2,3,4,5,6,7,8,9,10,11,12],b)?"Needs to be between 1 and 12":void 0},choices:function(b,c){return a.call(b,c)<0?"Not an acceptable value for this field":void 0},email:function(a,b){return/^[^@<\s>]+@[^@<\s>]+$/.test(b)?void 0:"That doesn't look like an email address"},url:function(a,b){return/^https?:\/\/.+\..+/.test(b)?void 0:"Not a valid url"},usTaxID:function(a,b){return/^\d{2}-?\d{1}-?\d{2}-?\d{4}$/.test(b)?void 0:"Not a valid tax ID"},ein:function(a,b){return/^\d{2}-?\d{7}$/.test(b)?void 0:"Not a valid EIN"},ssnLast4:function(a,b){return/^\d{4}$/.test(b)?void 0:"Not a valid last 4 digits for an SSN"},ownerPersonalID:function(a,b){var c;return c=function(){switch(a){case"CA":return/^\d{3}-?\d{3}-?\d{3}$/.test(b);case"US":return!0}}(),c?void 0:"Not a valid ID"},bizTaxID:function(a,b){var c,d,e,f,g,h,i,j;if(h={CA:["Tax ID",[/^\d{9}$/]],US:["EIN",[/^\d{2}-?\d{7}$/]]},g=h[a],null!=g){for(c=g[0],f=g[1],d=!1,i=0,j=f.length;j>i;i++)if(e=f[i],e.test(b)){d=!0;break}if(!d)return"Not a valid "+c}},zip:function(a,b){var c;return c=function(){switch(a.toUpperCase()){case"CA":return/^[\d\w]{6}$/.test(null!=b?b.replace(/\s+/g,""):void 0);case"US":return/^\d{5}$/.test(b)||/^\d{9}$/.test(b)}}(),c?void 0:"Not a valid zip"},bankAccountNumber:function(a,b){return/^\d{1,17}$/.test(b)?void 0:"Invalid bank account number"},usRoutingNumber:function(a){var b,c,d,e,f,g,h;if(!/^\d{9}$/.test(a))return"Routing number must have 9 digits";for(f=0,b=g=0,h=a.length-1;h>=g;b=g+=3)c=3*parseInt(a.charAt(b),10),d=7*parseInt(a.charAt(b+1),10),e=parseInt(a.charAt(b+2),10),f+=c+d+e;return 0===f||f%10!==0?"Invalid routing number":void 0},caRoutingNumber:function(a){return/^\d{5}\-\d{3}$/.test(a)?void 0:"Invalid transit number"},routingNumber:function(a,b){switch(a.toUpperCase()){case"CA":return this.caRoutingNumber(b);case"US":return this.usRoutingNumber(b)}},phoneNumber:function(a,b){var c;return c=b.replace(/[^0-9]/g,""),10!==c.length?"Invalid phone number":void 0},bizDBA:function(a,b){return/^.{1,23}$/.test(b)?void 0:"Statement descriptors can only have up to 23 characters"},nameLength:function(a,b){return 1===b.length?"Names need to be longer than one character":void 0}}}.call(this),window.FirehoseJS={};var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.UniqueArray=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.push=function(){var a,c,d,e;for(e=[],c=0,d=arguments.length;d>c;c++)a=arguments[c],-1===this.indexOf(a)?e.push(b.__super__.push.call(this,a)):e.push(void 0);return e},b.prototype.unshift=function(){var a,c,d,e;for(e=[],c=0,d=arguments.length;d>c;c++)a=arguments[c],-1===this.indexOf(a)?e.push(b.__super__.unshift.call(this,a)):e.push(void 0);return e},b.prototype.remove=function(a){var b;return b=this.indexOf(a),-1!==b?this.splice(b,1):void 0},b}(Array);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.RemoteArray=function(a){function b(a,b,c){var d=this;this._path=a,this._params=b||{},this._creationFunction=c,this._fetchingFunction=function(a){var b;return b={route:d._path,params:d._params,page:a,perPage:d.perPage},FirehoseJS.client.get(b).done(function(a){var b,c,e,f,g;if(a.constructor===Array&&a.length>0){for(d.totalRows=a[0].total_rows,g=[],e=0,f=a.length;f>e;e++)b=a[e],c=d._creationFunction(b),c._populateWithJSON(b),g.push(d.push(c));return g}})}}return __extends(b,a),b.prototype.perPage=-1,b.prototype.page=1,b.prototype.totalRows=0,b.prototype._path=null,b.prototype._params=null,b.prototype._creationFunction=null,b.prototype._fetchingFunction=null,b.prototype._fresh=!0,b.prototype.next=function(){return this._fresh||this.length!==this.totalRows?(this._fresh=!1,this._fetchingFunction(this.page++)):null},b.prototype.empty=function(){return this.length=0},b.prototype.reset=function(){return this.empty(),this.totalRows=0,this._fresh=!0,this.page=1},b}(FirehoseJS.UniqueArray),FirehoseJS.Client=function(){function a(){this._firefoxHack(),this._ensureEnvironment()}return a.prototype.APIAccessToken=null,a.prototype.URLToken=null,a.prototype.billingAccessToken=null,a.prototype.env=null,a.prototype.setEnvironment=function(a){return this.env=a,Stripe.setPublishableKey(this._environments[this.env].stripeKey)},a.prototype.get=function(a){return $.extend(a,{method:"GET"}),this._sendRequest(a)},a.prototype.post=function(a){return $.extend(a,{method:"POST"}),this._sendRequest(a)},a.prototype.put=function(a){return $.extend(a,{method:"PUT"}),this._sendRequest(a)},a.prototype["delete"]=function(a){return $.extend(a,{method:"DELETE"}),this._sendRequest(a)},a.prototype.serverAddress=function(a){return this._ensureEnvironment(),this._environments[this.env][""+a+"URL"]},a.prototype._sendRequest=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;this._ensureEnvironment(),c={server:"API",route:"",method:"GET",page:-1,perPage:-1,params:{},body:null},$.extend(c,a),l=c.server,k=c.route,f=c.method,g=c.page,j=c.perPage,i=c.params,b=c.body,g>-1&&(i.page=g),j>-1&&(i.per_page=j),h=[];for(e in i)n=i[e],null!=n&&h.push(""+e+"="+n);return m=""+this.serverAddress(l)+"/"+k,h.length>0&&(m+="?"+h.join("&")),d={Accept:"application/json"},null!=this.APIAccessToken&&"API"===l?$.extend(d,{Authorization:'Token token="'+this.APIAccessToken+'"'}):null!=this.billingAccessToken&&"billing"===l&&$.extend(d,{Authorization:'Token token="'+this.billingAccessToken+'"'}),$.ajax({type:f,url:m,data:b?JSON.stringify(b):void 0,processData:!1,dataType:"json",headers:d,contentType:"application/json"})},a.prototype._environments={production:{APIURL:"https://api.firehoseapp.com",browserURL:"https://firehoseapp.com",marketingURL:"https://getfirehose.com",billingURL:"https://billing.firehoseapp.com",stripeKey:"pk_live_CGPaLboKkpr7tqswA4elf8NQ"},development:{APIURL:"http://localhost:3000",browserURL:"http://localhost:3001",marketingURL:"http://localhost:3001",billingURL:"http://localhost:3002",stripeKey:"pk_test_oIyMNHil987ug1v8owRhuJwr"},test:{APIURL:"http://localhost:3001",browserURL:"http://localhost:3002",marketingURL:"http://localhost:3002",billingURL:"http://localhost:3003",stripeKey:"pk_test_oIyMNHil987ug1v8owRhuJwr"}},a.prototype._ensureEnvironment=function(){var a;if(null==this.env)return a=document.createElement("a"),a.href=document.URL,"localhost"===a.hostname?this.setEnvironment("development"):this.setEnvironment("production")},a.prototype._firefoxHack=function(){var a,b;return b=jQuery.ajaxSettings.xhr,a=["Cache-Control","Content-Language","Content-Type","Expires","Last-Modified","Pragma"],jQuery.ajaxSettings.xhr=function(){var c,d;return d=b(),c=d.getAllResponseHeaders,d.getAllResponseHeaders=function(){var b,e;b="";try{if(b=c.apply(d),null!=b)return b}catch(f){e=f}return $.each(a,function(a,c){return d.getResponseHeader(c)&&(b+=""+c+": "+d.getResponseHeader(c)+"\n"),!0}),b},d}},a}(),FirehoseJS.client=new FirehoseJS.Client,FirehoseJS.Object=function(){function a(){}return a.prototype.id=null,a.prototype.createdAt=null,a.prototype._populateAssociatedObjects=function(a,b,c,d){var e,f,g,h,i,j;if(null!=c){for(g=a[b]=new FirehoseJS.UniqueArray,j=[],h=0,i=c.length;i>h;h++)f=c[h],e=d(f),e._populateWithJSON(f),j.push(g.push(e));return j}},a.prototype._populateAssociatedObjectWithJSON=function(a,b,c,d){var e;return null!=c?(e=a[b]=d(c),e._populateWithJSON(c)):void 0},a.prototype._populateAssociatedObjectWithID=function(a,b,c,d){return a[b]=null!=c?d(c):null},a.prototype._populateWithJSON=function(a){return null==this.id&&(this.id=a.id),null!=this.createdAt?this.createdAt:this.createdAt=Date.parse(a.created_at)},a}();var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.Agent=function(a){function b(a,b){null!=b?(this.email=a,this._password=b):isNaN(parseInt(a))?"string"==typeof a&&(this.accessToken=a):this.id=a}return __extends(b,a),b.loggedInAgent=null,b.prototype.accessToken=null,b.prototype.URLToken=null,b.prototype.firstName=null,b.prototype.lastName=null,b.prototype.email=null,b.prototype.companies=new FirehoseJS.UniqueArray,b.prototype.currentCompany=null,b.prototype._password=null,b.prototype.signUpWithFirstAndLastName=function(a,b){var c,d=this;return this.firstName=a,this.lastName=b,c={route:"agents",body:{agent:{email:this.email,password:this._password,first_name:this.firstName,last_name:this.lastName}}},FirehoseJS.client.post(c).done(function(a){return d._populateWithJSON(a),FirehoseJS.client.APIAccessToken=d.accessToken,FirehoseJS.Agent.loggedInAgent=d})},b.prototype.login=function(){var a,b=this;return a={route:"login",body:{email:this.email,password:this._password}},FirehoseJS.client.post(a).done(function(a){return b._populateWithJSON(a),FirehoseJS.client.APIAccessToken=b.accessToken,FirehoseJS.Agent.loggedInAgent=b})},b.prototype.logout=function(){return this.accessToken=null,this.URLToken=null,FirehoseJS.Agent.loggedInAgent=null,FirehoseJS.client.APIAccessToken=null,FirehoseJS.client.URLToken=null,FirehoseJS.client.billingAccessToken=null},b.prototype.fetch=function(){var a,b=this;return a={route:"agents/"+this.id},FirehoseJS.client.get(a).done(function(a){return b._populateWithJSON(a),FirehoseJS.client.APIAccessToken=b.accessToken,FirehoseJS.Agent.loggedInAgent=b})},b.prototype.save=function(){var a;return a={route:"agents/"+this.id,body:this._toJSON()},FirehoseJS.client.put(a)},b.prototype.destroy=function(){var a;return a={route:"agents/"+this.id},FirehoseJS.client["delete"](a)},b.prototype.dismissNotifications=function(a){var b,c,d,e,f;for(b=[],e=0,f=a.length;f>e;e++)c=a[e],b.push(c.id);return d={route:"agents/"+this.id+"/notifications/"+b.join(",")},FirehoseJS.client.put(d).done(function(){var b,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],b=a.indexOf(c),f.push(a.splice(b,1));return f})},b.requestPasswordReset=function(a){var b;return b={route:"request_reset_password",body:{email:a}},FirehoseJS.client.post(b)},b.resetPassword=function(a,b){var c;return c={route:"reset_password",body:{token:a,password:b}},FirehoseJS.client.post(c)},b.prototype.setNewPassword=function(a){return this._password=a},b.prototype.fullName=function(){return""+this.firstName+" "+this.lastName},b.prototype._populateWithJSON=function(a){return null==this.accessToken&&(this.accessToken=a.access_token),null==this.URLToken&&(this.URLToken=a.url_token),this.firstName=a.first_name,this.lastName=a.last_name,this.email=a.email,this._populateAssociatedObjects(this,"companies",a.companies,function(a){return new FirehoseJS.Company(a.id,this)}),this.companies.length>0&&null==this.currentCompany&&(this.currentCompany=this.companies[0]),b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{agent:{first_name:this.firstName,last_name:this.lastName,email:this.email,password:null!=this._password?this._password:void 0}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.Company=function(a){function b(a,b){isNaN(parseInt(a))?"string"==typeof a&&(this.title=a,b.constructor===FirehoseJS.Agent&&(this._creator=b,this.agents.push(this._creator))):(this.id=a,null!=b&&b.constructor===FirehoseJS.Agent&&(this._creator=b,this.agents.push(this._creator)))}return __extends(b,a),b.prototype.title=null,b.prototype.token=null,b.prototype.lastFetchAt=null,b.prototype.fetchAutomatically=!0,b.prototype.forwardingEmailAddress=null,b.prototype.knowledgeBaseSubdomain=null,b.prototype.unresolvedCount=0,b.prototype.numberOfAccounts=0,b.prototype.agents=new FirehoseJS.UniqueArray,b.prototype.agentInvites=new FirehoseJS.UniqueArray,b.prototype.tags=new FirehoseJS.UniqueArray,b.prototype.cannedResponses=new FirehoseJS.UniqueArray,b.prototype._customers=null,b.prototype._notifications=null,b.prototype._twitterAccounts=null,b.prototype._facebookAccounts=null,b.prototype._emailAccounts=null,b.prototype.creditCard=null,b.prototype.billingEmail=null,b.prototype.billingRate=8,b.prototype.trialExpirationDate=null,b.prototype.nextBillingDate=null,b.prototype.isGracePeriodOver=!1,b.prototype.daysLeftInGracePeriod=-1,b.prototype.isCurrent=!1,b.prototype.hasSuccessfulBilling=!1,b._creator=null,b.prototype.fetch=function(){var a,b=this;return a={route:"companies/"+this.id},FirehoseJS.client.get(a).done(function(a){return b._populateWithJSON(a)})},b.prototype.save=function(){var a,b=this;return null!=this.id?(a={route:"companies/"+this.id,body:this._toJSON()},FirehoseJS.client.put(a)):(a={route:"agents/"+this._creator.id+"/companies",body:this._toJSON()},FirehoseJS.client.post(a).done(function(a){return b._populateWithJSON(a)}))},b.prototype.forceChannelsFetch=function(){var a;return a={route:"companies/"+this.id+"/force_channels_fetch"},FirehoseJS.client.put(a)},b.prototype.destroy=function(){var a;return a={route:"companies/"+this.id},FirehoseJS.client["delete"](a)},b.prototype.customersWithCriteria=function(a){var b,c=this;return null==a&&(a={}),b={filter:null!=a.resolved&&a.resolved?"resolved":"unresolved",channel:null!=a.channels?a.channels.join(","):void 0,sort:null!=a.sort?a.sort:void 0,search_text:a.searchString?a.searchString:void 0},new FirehoseJS.RemoteArray("companies/"+this.id+"/customers",b,function(a){return new FirehoseJS.Customer(a.id,c)})},b.prototype.notifications=function(){var a=this;return null==this._notifications&&(this._notifications=new FirehoseJS.RemoteArray("companies/"+this.id+"/notifications",null,function(b){return new FirehoseJS.Notification(b.id,a)})),this._notifications},b.prototype.twitterAccounts=function(){var a=this;return null==this._twitterAccounts&&(this._twitterAccounts=new FirehoseJS.RemoteArray("companies/"+this.id+"/twitter_accounts",null,function(b){return new FirehoseJS.TwitterAccount(b.id,a)})),this._twitterAccounts},b.prototype.facebookAccounts=function(){var a=this;return null==this._facebookAccounts&&(this._facebookAccounts=new FirehoseJS.RemoteArray("companies/"+this.id+"/facebook_accounts",null,function(b){return new FirehoseJS.FacebookAccount(b.id,a)})),this._facebookAccounts},b.prototype.emailAccounts=function(){var a=this;return null==this._emailAccounts&&(this._emailAccounts=new FirehoseJS.RemoteArray("companies/"+this.id+"/email_accounts",null,function(b){return new FirehoseJS.EmailAccount(b.id,a)})),this._emailAccounts},b.prototype.addAgent=function(a){var b,c=this;return b={route:"companies/"+this.id+"/agents/"+a.id},FirehoseJS.client.put(b).done(function(){return c.agents.push(a)})},b.prototype.removeAgent=function(a){var b,c=this;return b={route:"companies/"+this.id+"/agents/"+a.id},FirehoseJS.client["delete"](b).done(function(){return c.agents.remove(a)})},b.prototype.fetchBillingInfo=function(){var a,b=this;return a=function(){var a;return FirehoseJS.client.billingAccessToken=b.token,a={server:"billing",route:"entities/"+b.id},FirehoseJS.client.get(a).done(function(a){return null!=a.credit_card&&(b.creditCard=new FirehoseJS.CreditCard(b),b.creditCard._populateWithJSON(a.credit_card)),b.billingEmail=a.email||FirehoseJS.Agent.loggedInAgent.email,b.billingRate=a.rate/100,b.trialExpirationDate=Date.parse(a.free_trial_expiration_date||new Date(+new Date+12096e5))})},this.token?a():this.fetch().then(function(){return a()})},b.prototype._populateWithJSON=function(a){return this.title=a.title,null==this.token&&(this.token=a.token),this.fetchAutomatically=a.fetch_automatically,this.lastFetchAt=a.last_fetch_at,null==this.forwardingEmailAddress&&(this.forwardingEmailAddress=a.forwarding_email),this.knowledgeBaseSubdomain=a.kb_subdomain,this.unresolvedCount=a.unresolved_count,this.numberOfAccounts=a.number_of_accounts,this._populateAssociatedObjects(this,"agents",a.agents,function(a){var b;return b=new FirehoseJS.Agent(a.id),b.companies.push(this),b}),this._populateAssociatedObjects(this,"agentInvites",a.agent_invites,function(a){return new FirehoseJS.AgentInvite(a.id,this)}),this._populateAssociatedObjects(this,"tags",a.tags,function(a){return new FirehoseJS.Tag(a.id,this)}),this._populateAssociatedObjects(this,"cannedResponses",a.canned_responses,function(a){return new FirehoseJS.CannedResponse(a.id,this)}),FirehoseJS.client.billingAccessToken=this.token,b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{company:{title:this.title,fetch_automatically:this.fetchAutomatically}}},b}(FirehoseJS.Object);var _ref,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.Interaction=function(a){function b(){return _ref=b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.customer=null,b.prototype.token=null,b.prototype.responseDraft=null,b.prototype.happiness=null,b.prototype.resolved=!1,b.prototype.body=null,b.prototype.privateURL=null,b.prototype.channel=null,b.prototype.receivedAt=null,b.prototype.customerAccount=null,b.prototype.agent=null,b.prototype.responseInteractions=new FirehoseJS.UniqueArray,b.prototype.notes=new FirehoseJS.UniqueArray,b.prototype.tags=new FirehoseJS.UniqueArray,b.prototype.flaggedAgents=new FirehoseJS.UniqueArray,b.interactionWithJSON=function(a,b){var c;return c=null,"twitter"===a.channel?(c=new FirehoseJS.TwitterInteraction(a.id),c.customer=b):"facebook"===a.channel?(c=new FirehoseJS.FacebookInteraction(a.id),c.customer=b):"email"===a.channel&&(c=new FirehoseJS.EmailInteraction(a.id),c.customer=b),c._populateWithJSON(a),c},b.prototype.subject=function(){return this.constructor===FirehoseJS.EmailInteraction?this.emailSubject:this.constructor===FirehoseJS.TwitterInteraction?this.inReplyToScreenName?"Reply to "+this.inReplyToScreenName:"Mention of "+this.toScreenName:this.constructor===FirehoseJS.FacebookInteraction?this.type[0].toUpperCase()+this.type.slice(1):void 0},b.prototype.reply=function(){var a,b,c=this;return a={interaction:{body:this.responseDraft}},b={route:"interactions/"+this.id+"/reply",body:a},FirehoseJS.client.post(b).done(function(a){var b;return c.responseDraft=null,b=new FirehoseJS.Interaction(a,c.customer),c.responseInteractions.push(b),b.agent=FirehoseJS.Agent.loggedInAgent,c.responseInteractions.sort(function(a,b){return a.createdAt>b.createdAt})})},b.prototype.save=function(){var a;return a={route:"interactions/"+this.id,body:this._toJSON()},FirehoseJS.client.put(a)},b.prototype.destroy=function(){var a,b=this;return a={route:"interactions/"+this.id},FirehoseJS.client["delete"](a).done(function(){return b.customer.interactions().remove(b)})},b.prototype.addTag=function(a){var b,c=this;return b={route:"interactions/"+this.id+"/tags/"+a.id},FirehoseJS.client.put(b).done(function(){return c.tags.push(a)})},b.prototype.removeTag=function(a){var b,c=this;return b={route:"interactions/"+this.id+"/tags/"+a.id},FirehoseJS.client["delete"](b).done(function(){return c.tags.remove(a)})},b.prototype.flagAgent=function(a){var b,c=this;return b={route:"interactions/"+this.id+"/agents/"+a.id},FirehoseJS.client.put(b).done(function(){return c.flaggedAgents.push(a)})},b.prototype.unflagAgent=function(a){var b,c=this;return b={route:"interactions/"+this.id+"/agents/"+a.id},FirehoseJS.client["delete"](b).done(function(){return c.flaggedAgents.remove(a)})},b.prototype.happinessString=function(){return 0===this.happiness?"Upset":1===this.happiness?"Satisfied":2===this.happiness?"Happy":void 0},b.prototype._populateWithJSON=function(a){var c=this;return null==this.token&&(this.token=a.token),this.body=a.body,this.responseDraft=a.response_draft,this.channel=a.channel,this.receivedAt=Date.parse(a.received_at),this.privateURL=a.private_url,this.happiness=a.happiness,this.resolved=a.resolved,this._populateAssociatedObjectWithJSON(this,"agent",a.agent,function(a){return new FirehoseJS.Agent(a.id)}),this._populateAssociatedObjectWithJSON(this,"customerAccount",a.customer_account,function(a){return new FirehoseJS.CustomerAccount(a.id,c.customer)}),this._populateAssociatedObjects(this,"responseInteractions",a.response_interactions,function(a){return new FirehoseJS.Interaction(a,c.customer)}),this._populateAssociatedObjects(this,"notes",a.notes,function(a){return new FirehoseJS.Note(a.id,c)}),this._populateAssociatedObjects(this,"tags",a.tags,function(a){return new FirehoseJS.Tag(a.id,c.customer.company)}),this._populateAssociatedObjects(this,"flaggedAgents",a.flagged_agents,function(a){return new FirehoseJS.Agent(a.id)}),b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{interaction:{resolved:this.resolved,response_draft:this.responseDraft}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.AgentInvite=function(a){function b(a,b){isNaN(parseInt(a))?"string"==typeof a&&(this.toEmail=a,b.constructor===FirehoseJS.Company&&(this.company=b)):(this.id=a,null!=b&&b.constructor===FirehoseJS.Company&&(this.company=b))}return __extends(b,a),b.prototype.toEmail=null,b.prototype.company=null,b.prototype.save=function(){var a,b=this;return a={route:"companies/"+this.company.id+"/agent_invites",body:this._toJSON()},FirehoseJS.client.post(a).done(function(a){return b._populateWithJSON(a),b.company.agentInvites.push(b)})},b.prototype.resend=function(){var a;return a={route:"agent_invites/"+this.id+"/resend"},FirehoseJS.client.put(a)},b.prototype.destroy=function(){var a,b=this;return a={route:"agent_invites/"+this.id},FirehoseJS.client["delete"](a).done(function(){return b.company.agentInvites.remove(b)})},b.prototype._populateWithJSON=function(a){return this.email=a.email,b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{agent_invite:{email:this.toEmail}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.Attachment=function(a){function b(a,b){this.id=a,this.emailInteraction=b}return __extends(b,a),b.prototype.emailInteraction=null,b.prototype.filename=null,b.prototype.temporaryURL=null,b.prototype._populateWithJSON=function(a){return this.filename=a.filename,this.temporaryURL=a.temporary_url,b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.CannedResponse=function(a){function b(a,b,c){isNaN(parseInt(a))?"string"==typeof a&&(this.name=a,"string"==typeof b&&(this.text=b),c.constructor===FirehoseJS.Company&&(this.company=c)):(this.id=a,null!=b&&b.constructor===FirehoseJS.Company&&(this.company=b))}return __extends(b,a),b.prototype.company=null,b.prototype.name=null,b.prototype.shortcut=null,b.prototype.text=null,b.prototype.save=function(){var a,b=this;return null!=this.id?(a={route:"canned_responses/"+this.id,body:this._toJSON()},FirehoseJS.client.put(a)):(a={route:"companies/"+this.company.id+"/canned_responses",body:this._toJSON()},FirehoseJS.client.post(a).done(function(a){return b._populateWithJSON(a),b.company.cannedResponses.push(b)
}))},b.prototype.destroy=function(){var a,b=this;return a={route:"canned_responses/"+this.id},FirehoseJS.client["delete"](a).done(function(){return b.company.cannedResponses.remove(b)})},b.prototype._populateWithJSON=function(a){return this.name=a.name,this.shortcut=a.shortcut,this.text=a.text,b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{canned_response:{name:this.name,shortcut:this.shortcut,text:this.text}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.CreditCard=function(a){function b(a){this.company=a}return __extends(b,a),b.prototype.company=null,b.prototype.expirationMonth=null,b.prototype.expirationYear=null,b.prototype.lastFour=null,b.prototype.stripeToken=null,b.prototype.email=null,b.prototype.submitToStripe=function(a,b,c,d,e){var f=this;return Stripe.card.createToken({number:a,cvc:b,exp_month:c,exp_year:d},function(a,b){return b.error?void 0:(f.expirationMonth=b.card.exp_month,f.expirationYear=b.card.exp_year,f.lastFour=b.card.last4,f.stripeToken=b.id,f.email=FirehoseJS.Agent.loggedInAgent.email,e())})},b.prototype.save=function(){var a;return FirehoseJS.client.billingAccessToken=this.company.token,a={server:"billing",route:"entities/"+this.company.id+"/credit_card",body:this._toJSON()},FirehoseJS.client.put(a)},b.prototype.fetch=function(){var a,b=this;return FirehoseJS.client.billingAccessToken=this.company.token,a={server:"billing",route:"entities/"+this.company.id+"/credit_card"},FirehoseJS.client.get(a).done(function(a){return b._populateWithJSON(a)})},b.prototype.destroy=function(){var a;return FirehoseJS.client.billingAccessToken=this.company.token,a={server:"billing",route:"entities/"+this.company.id+"/credit_card"},FirehoseJS.client["delete"](a)},b.prototype._populateWithJSON=function(a){return this.expirationMonth=a.expiration_month,this.expirationYear=a.expiration_year,this.lastFour=a.last_four,b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{credit_card:{expiration_month:this.expirationMonth,expiration_year:this.expirationYear,last_four:this.lastFour,stripe_token:this.stripeToken,email:this.email}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.Customer=function(a){function b(a,b){this.id=a,b&&(this.company=b)}return __extends(b,a),b.prototype.company=null,b.prototype.name=null,b.prototype.location=null,b.prototype.timeZone=null,b.prototype.newestInteractionId=null,b.prototype.newestInteractionExcerpt=null,b.prototype.newestInteractionReceivedAt=null,b.prototype.agentWithDibs=null,b.prototype.customerAccounts=new FirehoseJS.UniqueArray,b.prototype.customerFlaggedAgents=new FirehoseJS.UniqueArray,b.prototype._interactions=null,b.prototype.fetch=function(){var a,b=this;return a={route:"customers/"+this.id},FirehoseJS.client.get(a).done(function(a){return b._populateWithJSON(a)})},b.prototype.resolveAllInteractions=function(){var a;return a={route:"customers/"+this.id+"/resolve_all_interactions"},FirehoseJS.client.put(a)},b.prototype.destroy=function(){var a;return a={route:"customers/"+this.id},FirehoseJS.client["delete"](a)},b.prototype.interactions=function(){var a=this;return null==this._interactions&&(this._interactions=new FirehoseJS.RemoteArray("customers/"+this.id+"/interactions",null,function(b){return new FirehoseJS.Interaction.interactionWithJSON(b,a)})),this._interactions},b.prototype._populateWithJSON=function(a){return this.name=a.name,this.location=a.location,this.timeZone=a.time_zone,this.newestInteractionId=a.newest_interaction_id,this.newestInteractionExcerpt=a.newest_interaction_excerpt,this.newestInteractionReceivedAt=Date.parse(a.newest_interaction_received_at),this._populateAssociatedObjects(this,"customerAccounts",a.customer_accounts,function(a){return new FirehoseJS.CustomerAccount(a.id,this)}),this._populateAssociatedObjects(this,"interactionFlaggedAgents",a.interaction_flagged_agents,function(a){return new FirehoseJS.Agent(a.id)}),this._populateAssociatedObjectWithJSON(this,"agentWithDibs",a.agent_with_dibs,function(a){return new FirehoseJS.Agent(a.id)}),b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.CustomerAccount=function(a){function b(a,b){this.id=a,this.customer=b}return __extends(b,a),b.prototype.customer=null,b.prototype.username=null,b.prototype.followingUs=null,b.prototype.imageURL=null,b.prototype.description=null,b.prototype.followersCount=null,b.prototype.channel=null,b.prototype._populateWithJSON=function(a){return this.username=a.username,this.followingUs=a.following_us,this.imageURL=a.image_url,this.description=a.description,this.followersCount=a.followers_count,this.channel=a.channel,b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.EmailAccount=function(a){function b(a,b,c){this.id=a,this.company=b,null!=c&&(null!=c.emailAddress&&(this.emailAddress=c.emailAddress),null!=c.title&&(this.title=c.title),null!=c.kind&&(this.kind=c.kind),null!=c.server&&(this.server=c.server),null!=c.port&&(this.port=c.port),null!=c.username&&(this.username=c.username),null!=c.password&&(this.password=c.password),null!=c.SSL&&(this.SSL=c.SSL),null!=c.deleteFromServer&&(this.deleteFromServer=c.deleteFromServer))}return __extends(b,a),b.prototype.company=null,b.prototype.emailAddress=null,b.prototype.title=null,b.prototype.kind="IMAP",b.prototype.server=null,b.prototype.port=null,b.prototype.username=null,b.prototype.password=null,b.prototype.SSL=!0,b.prototype.deleteFromServer=!1,b.prototype.save=function(){var a,b=this;return null!=this.id?(a={route:"email_accounts/"+this.id,body:this._toJSON()},FirehoseJS.client.put(a)):(a={route:"companies/"+this.company.id+"/email_accounts",body:this._toJSON()},FirehoseJS.client.post(a).done(function(a){return b._populateWithJSON(a)}))},b.prototype.destroy=function(){var a;return a={route:"email_accounts/"+this.id},FirehoseJS.client["delete"](a)},b.prototype._popularServices=[{domain:"gmail.com",kind:"IMAP",SSL:!0,port:993,server:"imap.googlemail.com"},{domain:"hotmail.com",kind:"POP",SSL:!0,port:995,server:"pop3.live.com"},{domain:"aol.com",kind:"IMAP",SSL:!0,port:993,server:"imap.aol.com"},{domain:"aim.com",kind:"IMAP",SSL:!0,port:993,server:"imap.aim.com"},{domain:"me.com",kind:"IMAP",SSL:!0,port:993,server:"imap.mail.me.com"},{domain:"mac.com",kind:"IMAP",SSL:!0,port:993,server:"imap.mail.me.com"},{domain:"icloud.com",kind:"IMAP",SSL:!0,port:993,server:"imap.mail.me.com"},{domain:"yahoo.com",kind:"IMAP",SSL:!0,port:993,server:"imap.mail.yahoo.com"}],b.prototype.guessFieldsFromEmail=function(){var a,b,c,d,e;for(e=this._popularServices,c=0,d=e.length;d>c;c++)if(b=e[c],a="@"+b.domain,-1!==this.username.indexOf(a))return this.kind=b.kind,this.SSL=b.SSL,this.port=b.port,this.server=b.server,!0;return!1},b.prototype._populateWithJSON=function(a){return this.emailAddress=a.email,null==this.title&&(this.title=a.title),this.server=a.incoming_server,this.SSL=a.incoming_ssl,null==this.port&&(this.port=a.incoming_port),this.username=a.incoming_username,this.kind=a.kind,this.deleteFromServer=a.delete_from_server,b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{email_account:{email:this.emailAddress,title:this.title,incoming_server:this.server,incoming_ssl:this.SSL,incoming_port:this.port,incoming_username:this.username,incoming_password:this.password,kind:this.kind,delete_from_server:this.deleteFromServer}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.EmailInteraction=function(a){function b(a){this.id=a}return __extends(b,a),b.prototype.emailSubject=null,b.prototype.replyTo=null,b.prototype.toEmail=null,b.prototype.fromEmail=null,b.prototype.attachments=new FirehoseJS.UniqueArray,b.prototype._populateWithJSON=function(a){var c,d=this;return c=a.email_interaction,this.emailSubject=c.subject,this.replyTo=c.reply_to,this.toEmail=c.to_email,this.fromEmail=c.from_email,this._populateAssociatedObjects(this,"attachments",c.attachments,function(a){return new FirehoseJS.Attachment(a.id,d)}),b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Interaction);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.FacebookAccount=function(a){function b(a,b){this.id=a,this.company=b}return __extends(b,a),b.prototype.company=null,b.prototype.username=null,b.prototype.facebookUserId=null,b.prototype.imageURL=null,b.prototype.name=null,b.prototype.facebookPages=new FirehoseJS.UniqueArray,b.OAuthURLForCompanyWithCallback=function(a,b){return""+FirehoseJS.client.serverAddress()+"/companies/"+a.id+"/oauth_facebook?url_token="+FirehoseJS.client.URLToken+"&callback_url="+b},b.prototype.destroy=function(){var a;return a={route:"facebook_accounts/"+this.id},FirehoseJS.client["delete"](a)},b.prototype._populateWithJSON=function(a){return this.username=a.username,this.facebookUserId=a.facebook_user_id,this.imageURL=a.image_url,this.name=a.name,this._populateAssociatedObjects(this,"facebookPages",a.facebook_pages,function(a){return new FirehoseJS.FacebookPage(a.id,this)}),b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.FacebookInteraction=function(a){function b(a){this.id=a}return __extends(b,a),b.prototype.fromUserId=null,b.prototype.fromName=null,b.prototype.toUserId=null,b.prototype.toName=null,b.prototype.postId=null,b.prototype.commentId=null,b.prototype.postType=null,b.prototype.postExcerpt=null,b.prototype.likeCount=0,b.prototype.type=null,b.prototype._populateWithJSON=function(a){var c;return c=a.facebook_interaction,this.fromUserId=c.from_user_id,this.fromName=c.from_name,this.toUserId=c.to_user_id,this.toName=c.to_name,this.postId=c.post_id,this.commentId=c.comment_id,this.postType=c.post_type,this.postExcerpt=c.post_excerpt,this.likeCount=c.like_count,b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Interaction);var _ref,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.FacebookPage=function(a){function b(){return _ref=b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.facebookAccount=null,b.prototype.name=null,b.prototype.category=null,b.prototype.pageId=null,b.prototype.active=!1,b.prototype.construction=function(a,b){return this.id=a,this.facebookAccount=b},b.prototype.save=function(){var a;return a={route:"facebook_pages/"+this.id,body:this._toJSON()},FirehoseJS.client.put(a)},b.prototype._populateWithJSON=function(a){return this.name=a.name,this.category=a.category,this.pageId=a.page_id,this.active=a.active,b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{facebook_page:{active:this.active}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.Note=function(a){function b(a,b){isNaN(parseInt(a))?"string"==typeof a&&(this.body=a,b instanceof FirehoseJS.Interaction&&(this.interaction=b)):(this.id=a,null!=b&&b instanceof FirehoseJS.Interaction&&(this.interaction=b))}return __extends(b,a),b.prototype.interaction=null,b.prototype.body=null,b.prototype.agent=null,b.prototype.save=function(){var a,b=this;return null!=this.id?(a={route:"notes/"+this.id,body:this._toJSON()},FirehoseJS.client.put(a)):(a={route:"interactions/"+this.interaction.id+"/notes",body:this._toJSON()},FirehoseJS.client.post(a).done(function(a){return b._populateWithJSON(a),b.interaction.notes.push(b),b.interaction.notes.sort(function(a,b){return a.createdAt>b.createdAt})}))},b.prototype.destroy=function(){var a,b=this;return a={route:"notes/"+this.id},FirehoseJS.client["delete"](a).done(function(){return b.interaction.notes.remove(b)})},b.prototype._populateWithJSON=function(a){return this.body=a.label,this._populateAssociatedObjectWithJSON(this,"agent",a.agent,function(a){return new FirehoseJS.Agent(a.id)}),b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{note:{body:this.body}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.Notification=function(a){function b(a,b){this.id=a,this.company=b}return __extends(b,a),b.prototype.company=null,b.prototype.title=null,b.prototype.text=null,b.prototype.level=0,b.prototype._populateWithJSON=function(a){return this.title=a.title,this.text=a.text,this.level=a.level,b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.OutgoingAttachment=function(a){function b(a){this.localURL=a}return __extends(b,a),b.prototype.filename=null,b.prototype.MIMEType=null,b.prototype.token=null,b.prototype.downloadURL=null,b.prototype.uploadURL=null,b.prototype.uploaded=!1,b.prototype.localURL=null,b.prototype.upload=function(a,b,c,d){var e,f=this;return e={route:"companies/"+this.id+"/outgoing_attachments",body:this._toJSON()},FirehoseJS.client.post(e).done(function(g){var h,i;return h=new XMLHttpRequest,"withCredentials"in h?h.open("PUT",g.upload_url,!0):"undefined"!=typeof XDomainRequest&&(h=new XDomainRequest,h.open("PUT",g.upload_url)),null!=(i=h.upload)&&i.addEventListener("progress",function(a){var b;return a.lengthComputable?(b=parseInt(a.loaded/a.total*100,10),b>=95?d(95):d(b)):void 0}),h.onload=function(){return 200===h.status?(e={route:"outgoing_attachments/"+g.id,body:f._toJSON()},FirehoseJS.client.post(e).done(function(){return b()}).fail(function(a,b,d){return c(d)})):c("Your attachment failed to upload successfully, please try again. Please contact support@getfirehose.com if the problem persists and we'll get it fixed for you.")},h.setRequestHeader("Content-Type",a.type),h.setRequestHeader("x-amz-acl","authenticated-read"),h.send(a)}).fail(function(a,b,d){return c(d)})},b.prototype._toJSON=function(){return{outgoing_attachment:{filename:this.filename,mimetype:this.MIMEType,uploaded:this.uploaded}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.Tag=function(a){function b(a,b){isNaN(parseInt(a))?"string"==typeof a&&(this.label=a,b.constructor===FirehoseJS.Company&&(this.company=b)):(this.id=a,null!=b&&b.constructor===FirehoseJS.Company&&(this.company=b))}return __extends(b,a),b.prototype.company=null,b.prototype.label=null,b.prototype.save=function(){var a,b=this;return null!=this.id?(a={route:"tags/"+this.id,body:this._toJSON()},FirehoseJS.client.put(a)):(a={route:"companies/"+this.company.id+"/tags",body:this._toJSON()},FirehoseJS.client.post(a).done(function(a){return b._populateWithJSON(a),b.company.tags.push(b)}))},b.prototype.destroy=function(){var a,b=this;return a={route:"tags/"+this.id},FirehoseJS.client["delete"](a).done(function(){return b.company.tags.remove(b)})},b.prototype._populateWithJSON=function(a){return this.label=a.label,b.__super__._populateWithJSON.call(this,a)},b.prototype._toJSON=function(){return{tag:{label:this.label}}},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.TwitterAccount=function(a){function b(a,b){this.id=a,this.company=b}return __extends(b,a),b.prototype.company=null,b.prototype.screenName=null,b.prototype.twitterUserId=null,b.prototype.imageURL=null,b.OAuthURLForCompanyWithCallback=function(a,b){return""+FirehoseJS.client.serverAddress()+"/companies/"+a.id+"/oauth_twitter?url_token="+FirehoseJS.client.URLToken+"&callback_url="+b},b.prototype.destroy=function(){var a;return a={route:"facebook_accounts/"+this.id},FirehoseJS.client["delete"](a)},b.prototype._populateWithJSON=function(a){return this.screenName=a.screen_name,this.twitterUserId=a.twitter_user_id,this.imageURL=a.image_url,b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Object);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};FirehoseJS.TwitterInteraction=function(a){function b(a){this.id=a}return __extends(b,a),b.prototype.favorited=!1,b.prototype.tweetId=null,b.prototype.inReplyToScreenName=null,b.prototype.inReplyToStatusId=null,b.prototype.retweetCount=0,b.prototype.tweetSource=null,b.prototype.toUserId=null,b.prototype.toScreenName=null,b.prototype.fromUserId=null,b.prototype._populateWithJSON=function(a){var c;return c=a.twitter_interaction,this.favorited=c.favorited,this.tweetId=c.tweet_id,this.inReplyToScreenName=c.in_reply_to_screen_name,this.inReplyToStatusId=c.in_reply_to_status_id,this.retweetCount=c.retweet_count,this.tweetSource=c.tweet_source,this.toUserId=c.to_user_id,this.toScreenName=c.twitter_account.screen_name,this.fromUserId=c.from_user_id,b.__super__._populateWithJSON.call(this,a)},b}(FirehoseJS.Interaction),FirehoseJS.Utils=function(){function a(){}return a.prototype.APIURL=function(){return FirehoseJS.client.serverAddress("API")},a.prototype.browserURL=function(){return FirehoseJS.client.serverAddress("browser")},a.prototype.marketingURL=function(){return FirehoseJS.client.serverAddress("marketing")},a.prototype.billingURL=function(){return FirehoseJS.client.serverAddress("billing")},a}();